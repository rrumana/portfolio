---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import PageSection from '../components/shell/PageSection.astro';
import Text from '../components/ui/Text.astro';
import Button from '../components/ui/Button.astro';
import ProjectCard from '../components/cards/ProjectCard.astro';
import CallToAction from '../components/callouts/CallToAction.astro';
import SplitSection from '../components/layouts/SplitSection.astro';
import Hero from '../components/sections/Hero.astro';
import { siteConfig } from '../site.config';

const navLinks = siteConfig.navigation.home;
const resumeUrl = siteConfig.contact.resumeUrl;
const emailLink = `mailto:${siteConfig.contact.email}`;
const githubLink =
  siteConfig.social.find((link) => link.label === 'GitHub')?.href ?? 'https://github.com/rrumana';

const projects = await getCollection('projects');
projects.sort((a, b) => a.data.order - b.data.order);
---
<BaseLayout
  title="Ryan Rumana | Portfolio"
  description="Software engineer and platform builder focused on Rust, Kubernetes, and resilient homelab infrastructure."
  navLinks={navLinks}
>
  <main>
    <Hero
      eyebrow="Machine Learning Engineer"
      title="Hi, I'm Ryan Rumana"
      description="I build resilient systems that blend Rust, Kubernetes, and automation—powering production-ready homelabs, WASM experiences, and AI workloads at the edge."
      primaryCta={{ label: 'Get in touch', href: '#contact' }}
      secondaryCta={{ label: 'Download résumé', href: resumeUrl }}
    />

    <PageSection
      id="about"
      title="About"
      description="Engineer, adventurer, and perpetual learner—rooted in Rust and inspired by the outdoors."
      variant="alt"
    >
      <SplitSection>
        <picture slot="media" class="about__image">
          <source srcset="/images/profile.webp" type="image/webp" />
          <img
            src="/images/profile.png"
            alt="Ryan Rumana portrait"
            width="450"
            height="350"
            loading="lazy"
          />
        </picture>
        <div class="about__copy">
          <Text>
            I'm a software engineer with roots in Tallahassee and degrees in Computer Science and Machine Learning from
            the Colorado School of Mines. I thrive on building—from Rust tooling and Kubernetes platforms to custom PCs
            and interactive experiments.
          </Text>
          <Text>
            When I'm not experimenting with infrastructure, you'll likely find me outside: hiking, snowboarding, or training
            for triathlons. That curiosity drives this site, where I share projects that combine performance, automation,
            and thoughtful design.
          </Text>
          <div class="about__actions">
            <Button href={resumeUrl}>View résumé</Button>
            <Button href={emailLink} variant="secondary">Contact</Button>
          </div>
        </div>
      </SplitSection>
    </PageSection>

    <PageSection
      id="projects"
      title="Projects"
      description="Every build I'm actively maintaining, from homelab platforms to tooling experiments."
    >
      <div class="project-stack">
        {projects.map((project) => (
          <ProjectCard
            title={project.data.title}
            summary={project.data.summary}
            techStack={project.data.techStack}
            media={project.data.heroImage}
            mediaAlt={project.data.heroAlt}
            cta={project.data.primaryAction}
            secondaryCta={project.data.secondaryAction}
          />
        ))}
      </div>
    </PageSection>

    <CallToAction
      id="contact"
      eyebrow="Let’s talk"
      title="Interested in collaborating or trading homelab war stories?"
      description="I’m always open to comparing setups, chatting about Rust, or teaming up on platform engineering projects."
      actions={[
        { label: 'Email me', href: emailLink },
        { label: 'View GitHub', href: githubLink, variant: 'secondary' },
      ]}
    />

    <div aria-hidden="true"></div>
  </main>
</BaseLayout>

<style>
.about__copy {
  display: grid;
  gap: var(--space-md);
}

.about__actions {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-sm);
  margin-top: var(--space-md);
}

.project-stack {
  display: grid;
  gap: var(--space-2xl);
}

.project-stack > * {
  width: 100%;
}
</style>
